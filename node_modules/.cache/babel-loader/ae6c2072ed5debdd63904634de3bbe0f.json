{"ast":null,"code":"var _formatTime;\n\nimport loginedApi from \"../apis\";\nimport { toast } from \"react-toastify\";\nimport CryptoJS from \"crypto-js\";\nimport axios from \"axios\";\nimport { LOGIN_SUCCESS_ACTION, LOG_OUT_ACTION, UPDATE_LOGIN } from \"./type\";\n\nconst qs = require('qs');\n\nconst FormData = require('form-data');\n\nconst publicIp = require(\"public-ip\");\n\nlet IP = publicIp.v4();\n\nconst {\n  detect\n} = require(\"detect-browser\");\n\nconst browser = detect();\nlet platform = window.navigator.platform;\nlet userAgent = window.navigator.userAgent;\nlet off = new Date().toString().replace(/GMT\\+(\\d\\d)(\\d\\d)/, \"GMT+$1:$2\");\nlet formatTime = off === null || off === void 0 ? void 0 : off.split(\"GMT\")[1].split(\" (\")[0];\nlet result = (_formatTime = formatTime) === null || _formatTime === void 0 ? void 0 : _formatTime.slice(1);\n\nif (formatTime.search(/\\+/g) != null) {\n  formatTime = formatTime.replace(/\\+/g, \"%2B\");\n} else if (formatTime.search(/\\-/g) != null) {\n  formatTime = formatTime.replace(/\\-/g, \"%2D\");\n} //replace(/\\+/g,' ') browserTimeZone: `GMT${formatTime}`\n\n\nexport const loginAction = ({\n  loginType,\n  userName,\n  accessCountry,\n  password,\n  history,\n  backupData,\n  setDrSign\n}) => async dispatch => {\n  var _res$data, _res$data$data;\n\n  let resp = await loginedApi.post(\"getcountrycode\", {\n    token: \"token\",\n    version: \"2.0\",\n    data: {\n      browserTimeZone: `GMT${formatTime}`\n    },\n    requestType: 1058\n  });\n  const doctorscountrycode = resp.data.data;\n  console.log(backupData);\n  var hash = CryptoJS.SHA512(\"C2MD|\" + password); // var hash = CryptoJS.SHA512(password);\n\n  const res = await loginedApi.post(\"login\", {\n    token: \"token\",\n    data: {\n      isFromMobile: true,\n      clinicId: \"20\",\n      deviceId: \"\",\n      appname: \"C2MD Patient\",\n      hashPassword: hash.toString(CryptoJS.enc.Base64),\n      password: hash.toString(),\n      loginType: loginType,\n      userName: userName,\n      browserTimeZone: `GMT${formatTime}`,\n      Ipaddress: doctorscountrycode.Ipaddress,\n      useragent: userAgent,\n      Browser: browser.name + \" \" + browser.version,\n      Os: platform,\n      currency: doctorscountrycode.currency,\n      accessCountry: doctorscountrycode.Country\n    },\n    requestType: 3\n  });\n\n  if (res === null || res === void 0 ? void 0 : (_res$data = res.data) === null || _res$data === void 0 ? void 0 : (_res$data$data = _res$data.data) === null || _res$data$data === void 0 ? void 0 : _res$data$data.info) {\n    return res.data.data;\n  } else {\n    var _res$data2, _res$data2$data;\n\n    dispatch({\n      type: LOGIN_SUCCESS_ACTION,\n      payload: res.data.data\n    });\n    await localStorage.setItem(\"userData\", JSON.stringify(res.data.data));\n\n    if (((_res$data2 = res.data) === null || _res$data2 === void 0 ? void 0 : (_res$data2$data = _res$data2.data) === null || _res$data2$data === void 0 ? void 0 : _res$data2$data.userType) == \"Patient\") {\n      var _history$location, _history$location$sta;\n\n      console.log(backupData);\n\n      if (backupData && (backupData === null || backupData === void 0 ? void 0 : backupData.redirection)) {\n        history.push(backupData === null || backupData === void 0 ? void 0 : backupData.redirection);\n      } else if (history === null || history === void 0 ? void 0 : (_history$location = history.location) === null || _history$location === void 0 ? void 0 : (_history$location$sta = _history$location.state) === null || _history$location$sta === void 0 ? void 0 : _history$location$sta.redirection) {\n        var _history$location2, _history$location2$st;\n\n        history.push(history === null || history === void 0 ? void 0 : (_history$location2 = history.location) === null || _history$location2 === void 0 ? void 0 : (_history$location2$st = _history$location2.state) === null || _history$location2$st === void 0 ? void 0 : _history$location2$st.redirection);\n      } else {\n        history.push(\"/dashboard\");\n      }\n    } else {\n      // history.push(\"/dashboard\");\n      // setDrSign(true)\n      let login = {\n        isFromMobile: true,\n        Ipaddress: IP,\n        clinicId: \"20\",\n        deviceId: \"\",\n        browserTimeZone: `GMT${formatTime}`,\n        appname: \"C2MD Patient\",\n        Os: platform,\n        hashPassword: \"\",\n        useragent: userAgent,\n        password: \"\",\n        accessCountry: accessCountry,\n        loginType: loginType,\n        userName: userName,\n        isotpverified: true,\n        Browser: browser.name + \" \" + browser.version\n      };\n      axios({\n        method: 'post',\n        url: 'https://uat.c2mdr.com/demo/Connect2MyDoctorRequest',\n        data: {\n          requestType: 3,\n          loginDetails: JSON.stringify(login)\n        },\n        headers: {\n          'content-type': 'application/x-www-form-urlencoded;charset=utf-8'\n        }\n      }).then(response => {\n        console.log(response);\n      }).catch(err => {\n        throw err;\n      });\n    }\n  }\n\n  return res.data.data;\n};\nexport const checkUser = ({\n  type,\n  searchkey\n}) => async dispatch => {\n  const response = await loginedApi.post(\"loginwithotp\", {\n    requestType: 15,\n    token: \"C2MDVerificationToken\",\n    data: {\n      type: type,\n      searchKey: searchkey\n    }\n  });\n\n  if (response.status === 200) {\n    return response.data && response.data;\n  }\n};\nexport const logoutAction = () => async dispatch => {\n  dispatch({\n    type: LOG_OUT_ACTION\n  });\n  localStorage.removeItem(\"userData\");\n};\nexport const loginwithotp = ({\n  loginType,\n  userName,\n  accessCountry,\n  history,\n  appoinment_form\n}) => async dispatch => {\n  const res = await loginedApi.post(\"login\", {\n    token: \"token\",\n    data: {\n      isFromMobile: true,\n      Ipaddress: IP,\n      clinicId: \"20\",\n      deviceId: \"\",\n      browserTimeZone: `GMT${formatTime}`,\n      appname: \"C2MD Patient\",\n      Os: platform,\n      hashPassword: \"\",\n      useragent: userAgent,\n      password: \"\",\n      accessCountry: accessCountry,\n      loginType: loginType,\n      userName: userName,\n      isotpverified: true,\n      Browser: browser.name + \" \" + browser.version\n    },\n    requestType: 3\n  });\n  console.log(res);\n\n  if (res.data.data.info) {\n    toast.error(\"Invalid username or password !\", {\n      position: \"top-right\",\n      autoClose: 5000,\n      hideProgressBar: true,\n      closeOnClick: true,\n      pauseOnHover: true,\n      draggable: true,\n      progress: undefined\n    });\n  } else {\n    var _res$data3, _res$data3$data, _res$data4, _res$data4$data;\n\n    dispatch({\n      type: LOGIN_SUCCESS_ACTION,\n      payload: res.data.data\n    }); //await localStorage.setItem(\"userData\", JSON.stringify(res.data.data));\n\n    console.log((_res$data3 = res.data) === null || _res$data3 === void 0 ? void 0 : (_res$data3$data = _res$data3.data) === null || _res$data3$data === void 0 ? void 0 : _res$data3$data.userType);\n\n    if (((_res$data4 = res.data) === null || _res$data4 === void 0 ? void 0 : (_res$data4$data = _res$data4.data) === null || _res$data4$data === void 0 ? void 0 : _res$data4$data.userType) == \"Patient\") {\n      if (appoinment_form === null || appoinment_form === void 0 ? void 0 : appoinment_form.routing) {\n        let doctrId = localStorage.getItem(\"doctrID\");\n        history.push(`/BookAppointment/${doctrId}`);\n      } else {\n        history.push(\"/dashboard\");\n      }\n    } else {\n      let requestOptions = {\n        headers: {\n          'Content-Type': 'application/x-www-form-urlencoded'\n        }\n      };\n      let body = {\n        token: \"token\",\n        data: {\n          isFromMobile: true,\n          Ipaddress: IP,\n          clinicId: \"20\",\n          deviceId: \"\",\n          browserTimeZone: `GMT${formatTime}`,\n          appname: \"C2MD Patient\",\n          Os: platform,\n          hashPassword: \"\",\n          useragent: userAgent,\n          password: \"\",\n          accessCountry: accessCountry,\n          loginType: loginType,\n          userName: userName,\n          isotpverified: true,\n          Browser: browser.name + \" \" + browser.version\n        },\n        requestType: 3\n      };\n      return axios.post('https://uat.c2mdr.com/demo/Connect2MyDoctorRequest', JSON.stringify(body), requestOptions).then(response => {\n        return response;\n      }).catch(err => {\n        throw err;\n      }); //history.push(\"/dashboard\");\n    }\n  }\n};\nexport const loginWithGoogle = ({\n  Data,\n  history\n}) => async dispatch => {\n  const res = await loginedApi.post(\"login\", {\n    token: \"token\",\n    data: {\n      isFromMobile: true,\n      Ipaddress: IP,\n      clinicId: \"20\",\n      deviceId: \"\",\n      browserTimeZone: `GMT${formatTime}`,\n      appname: \"C2MD Patient\",\n      Os: platform,\n      hashPassword: \"\",\n      useragent: userAgent,\n      password: \"\",\n      accessCountry: \"IN\",\n      loginType: \"email\",\n      userName: Data === null || Data === void 0 ? void 0 : Data.email,\n      isotpverified: true,\n      Browser: browser.name + \" \" + browser.version\n    },\n    requestType: 3\n  });\n\n  if (res.data.data.info) {\n    return res.data.data;\n  } else {\n    dispatch({\n      type: LOGIN_SUCCESS_ACTION,\n      payload: res.data.data\n    });\n    await localStorage.setItem(\"userData\", JSON.stringify(res.data.data));\n    history.push(\"/DoctorListing\");\n  }\n\n  return res.data.data;\n};\nexport const updateLoginDetails = data => async dispatch => {\n  dispatch({\n    type: UPDATE_LOGIN,\n    payload: data\n  });\n};","map":{"version":3,"sources":["/home/veena/Downloads/WEB_PUSH/c2md-web_react/src/actions/LoginAction.js"],"names":["loginedApi","toast","CryptoJS","axios","LOGIN_SUCCESS_ACTION","LOG_OUT_ACTION","UPDATE_LOGIN","qs","require","FormData","publicIp","IP","v4","detect","browser","platform","window","navigator","userAgent","off","Date","toString","replace","formatTime","split","result","slice","search","loginAction","loginType","userName","accessCountry","password","history","backupData","setDrSign","dispatch","resp","post","token","version","data","browserTimeZone","requestType","doctorscountrycode","console","log","hash","SHA512","res","isFromMobile","clinicId","deviceId","appname","hashPassword","enc","Base64","Ipaddress","useragent","Browser","name","Os","currency","Country","info","type","payload","localStorage","setItem","JSON","stringify","userType","redirection","push","location","state","login","isotpverified","method","url","loginDetails","headers","then","response","catch","err","checkUser","searchkey","searchKey","status","logoutAction","removeItem","loginwithotp","appoinment_form","error","position","autoClose","hideProgressBar","closeOnClick","pauseOnHover","draggable","progress","undefined","routing","doctrId","getItem","requestOptions","body","loginWithGoogle","Data","email","updateLoginDetails"],"mappings":"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","sourcesContent":["import loginedApi from \"../apis\";\nimport { toast } from \"react-toastify\";\nimport CryptoJS from \"crypto-js\";\nimport axios from \"axios\";\nimport { LOGIN_SUCCESS_ACTION, LOG_OUT_ACTION, UPDATE_LOGIN } from \"./type\";\nconst qs = require('qs')\nconst FormData = require('form-data');\n\nconst publicIp = require(\"public-ip\");\nlet IP = publicIp.v4();\nconst { detect } = require(\"detect-browser\");\nconst browser = detect();\n\nlet platform = window.navigator.platform;\nlet userAgent = window.navigator.userAgent;\nlet off = new Date().toString().replace(/GMT\\+(\\d\\d)(\\d\\d)/, \"GMT+$1:$2\");\nlet formatTime = off?.split(\"GMT\")[1].split(\" (\")[0];\nlet result = formatTime?.slice(1);\nif (formatTime.search(/\\+/g) != null) {\n  formatTime = formatTime.replace(/\\+/g, \"%2B\");\n} else if (formatTime.search(/\\-/g) != null) {\n  formatTime = formatTime.replace(/\\-/g, \"%2D\");\n} //replace(/\\+/g,' ') browserTimeZone: `GMT${formatTime}`\n\nexport const loginAction =\n  ({\n    loginType,\n    userName,\n    accessCountry,\n    password,\n    history,\n    backupData,\n    setDrSign,\n  }) =>\n  async (dispatch) => {\n    let resp = await loginedApi.post(\"getcountrycode\", {\n      token: \"token\",\n      version: \"2.0\",\n      data: { browserTimeZone: `GMT${formatTime}` },\n      requestType: 1058,\n    });\n    const doctorscountrycode = resp.data.data;\n\n    console.log(backupData);\n    var hash = CryptoJS.SHA512(\"C2MD|\" + password);\n    // var hash = CryptoJS.SHA512(password);\n    const res = await loginedApi.post(\"login\", {\n      token: \"token\",\n      data: {\n        isFromMobile: true,\n        clinicId: \"20\",\n        deviceId: \"\",\n        appname: \"C2MD Patient\",\n        hashPassword: hash.toString(CryptoJS.enc.Base64),\n        password: hash.toString(),\n        loginType: loginType,\n        userName: userName,\n        browserTimeZone: `GMT${formatTime}`,\n        Ipaddress: doctorscountrycode.Ipaddress,\n        useragent: userAgent,\n        Browser: browser.name + \" \" + browser.version,\n        Os: platform,\n        currency: doctorscountrycode.currency,\n        accessCountry: doctorscountrycode.Country,\n      },\n      requestType: 3,\n    });\n\n    if (res?.data?.data?.info) {\n      return res.data.data;\n    } else {\n      dispatch({ type: LOGIN_SUCCESS_ACTION, payload: res.data.data });\n\n      await localStorage.setItem(\"userData\", JSON.stringify(res.data.data));\n\n      if (res.data?.data?.userType == \"Patient\") {\n        console.log(backupData);\n        if (backupData && backupData?.redirection) {\n          history.push(backupData?.redirection);\n        } else if (history?.location?.state?.redirection) {\n          history.push(history?.location?.state?.redirection);\n        } else {\n          history.push(\"/dashboard\");\n        }\n      } else {\n       // history.push(\"/dashboard\");\n        // setDrSign(true)\n\n       \n      let login = {\n        isFromMobile: true,\n              Ipaddress: IP,\n              clinicId: \"20\",\n              deviceId: \"\",\n              browserTimeZone: `GMT${formatTime}`,\n              appname: \"C2MD Patient\",\n              Os: platform,\n              hashPassword: \"\",\n              useragent: userAgent,\n              password: \"\",\n              accessCountry: accessCountry,\n              loginType: loginType,\n              userName: userName,\n              isotpverified: true,\n              Browser: browser.name + \" \" + browser.version,\n      };\n\n        axios({\n          method: 'post',\n          url: 'https://uat.c2mdr.com/demo/Connect2MyDoctorRequest',\n          data: {\n            requestType: 3,\n            loginDetails: JSON.stringify(login)\n        },\n          \n          headers: {\n            'content-type': 'application/x-www-form-urlencoded;charset=utf-8'\n          }\n        }).then(response => {\n          console.log(response)\n      })\n      .catch(err => {\n          throw err;\n      });\n\n      \n    \n      \n  \n      \n      }\n    }\n    return res.data.data;\n  };\n\nexport const checkUser =\n  ({ type, searchkey }) =>\n  async (dispatch) => {\n    const response = await loginedApi.post(\"loginwithotp\", {\n      requestType: 15,\n      token: \"C2MDVerificationToken\",\n      data: { type: type, searchKey: searchkey },\n    });\n\n    if (response.status === 200) {\n      return response.data && response.data;\n    }\n  };\n\nexport const logoutAction = () => async (dispatch) => {\n  dispatch({ type: LOG_OUT_ACTION });\n  localStorage.removeItem(\"userData\");\n};\n\nexport const loginwithotp =\n  ({ loginType, userName, accessCountry, history, appoinment_form }) =>\n  async (dispatch) => {\n    const res = await loginedApi.post(\"login\", {\n      token: \"token\",\n      data: {\n        isFromMobile: true,\n        Ipaddress: IP,\n        clinicId: \"20\",\n        deviceId: \"\",\n        browserTimeZone: `GMT${formatTime}`,\n        appname: \"C2MD Patient\",\n        Os: platform,\n        hashPassword: \"\",\n        useragent: userAgent,\n        password: \"\",\n        accessCountry: accessCountry,\n        loginType: loginType,\n        userName: userName,\n        isotpverified: true,\n        Browser: browser.name + \" \" + browser.version,\n      },\n      requestType: 3,\n    });\n\n    console.log(res);\n\n    if (res.data.data.info) {\n      toast.error(\"Invalid username or password !\", {\n        position: \"top-right\",\n        autoClose: 5000,\n        hideProgressBar: true,\n        closeOnClick: true,\n        pauseOnHover: true,\n        draggable: true,\n        progress: undefined,\n      });\n    } else {\n      dispatch({\n        type: LOGIN_SUCCESS_ACTION,\n        payload: res.data.data,\n      });\n\n      //await localStorage.setItem(\"userData\", JSON.stringify(res.data.data));\n      console.log(res.data?.data?.userType);\n      if (res.data?.data?.userType == \"Patient\") {\n        if (appoinment_form?.routing) {\n          let doctrId = localStorage.getItem(\"doctrID\");\n\n          history.push(`/BookAppointment/${doctrId}`);\n        } else {\n          history.push(\"/dashboard\");\n        }\n      } else {\n        let requestOptions = {\n          headers: {\n              'Content-Type': 'application/x-www-form-urlencoded'\n          }\n      };\n  \n      let body = {\n        token: \"token\",\n        data: {\n          isFromMobile: true,\n          Ipaddress: IP,\n          clinicId: \"20\",\n          deviceId: \"\",\n          browserTimeZone: `GMT${formatTime}`,\n          appname: \"C2MD Patient\",\n          Os: platform,\n          hashPassword: \"\",\n          useragent: userAgent,\n          password: \"\",\n          accessCountry: accessCountry,\n          loginType: loginType,\n          userName: userName,\n          isotpverified: true,\n          Browser: browser.name + \" \" + browser.version,\n        },\n        requestType: 3,\n      };\n  \n      return axios.post('https://uat.c2mdr.com/demo/Connect2MyDoctorRequest', JSON.stringify(body), requestOptions)\n          .then(response => {\n              return response;\n          })\n          .catch(err => {\n              throw err;\n          });\n        //history.push(\"/dashboard\");\n      }\n    }\n  };\n\nexport const loginWithGoogle =\n  ({ Data, history }) =>\n  async (dispatch) => {\n    \n    const res = await loginedApi.post(\"login\", {\n      token: \"token\",\n      data: {\n        isFromMobile: true,\n        Ipaddress: IP,\n        clinicId: \"20\",\n        deviceId: \"\",\n        browserTimeZone: `GMT${formatTime}`,\n        appname: \"C2MD Patient\",\n        Os: platform,\n        hashPassword: \"\",\n        useragent: userAgent,\n        password: \"\",\n        accessCountry: \"IN\",\n        loginType: \"email\",\n        userName: Data?.email,\n        isotpverified: true,\n        Browser: browser.name + \" \" + browser.version,\n      },\n      requestType: 3,\n    });\n\n    if (res.data.data.info) {\n      return res.data.data;\n    } else {\n      dispatch({ type: LOGIN_SUCCESS_ACTION, payload: res.data.data });\n\n      await localStorage.setItem(\"userData\", JSON.stringify(res.data.data));\n      history.push(\"/DoctorListing\");\n    }\n    return res.data.data;\n  };\n\nexport const updateLoginDetails = (data) => async (dispatch) => {\n  dispatch({ type: UPDATE_LOGIN, payload: data });\n};\n"]},"metadata":{},"sourceType":"module"}