{"ast":null,"code":"'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) {\n  return typeof obj;\n} : function (obj) {\n  return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n};\n\nvar _createClass = function () {\n  function defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descriptor);\n    }\n  }\n\n  return function (Constructor, protoProps, staticProps) {\n    if (protoProps) defineProperties(Constructor.prototype, protoProps);\n    if (staticProps) defineProperties(Constructor, staticProps);\n    return Constructor;\n  };\n}();\n\nvar _react = require('react');\n\nvar _react2 = _interopRequireDefault(_react);\n\nvar _propTypes = require('prop-types');\n\nvar _propTypes2 = _interopRequireDefault(_propTypes);\n\nvar _uuid = require('uuid');\n\nvar _uuid2 = _interopRequireDefault(_uuid);\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nfunction _possibleConstructorReturn(self, call) {\n  if (!self) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self;\n}\n\nfunction _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass);\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      enumerable: false,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass;\n}\n\nvar OTSubscriber = function (_Component) {\n  _inherits(OTSubscriber, _Component);\n\n  function OTSubscriber(props, context) {\n    _classCallCheck(this, OTSubscriber);\n\n    var _this = _possibleConstructorReturn(this, (OTSubscriber.__proto__ || Object.getPrototypeOf(OTSubscriber)).call(this, props));\n\n    _this.state = {\n      subscriber: null,\n      stream: props.stream || context.stream || null,\n      session: props.session || context.session || null,\n      currentRetryAttempt: 0\n    };\n    _this.maxRetryAttempts = props.maxRetryAttempts || 5;\n    _this.retryAttemptTimeout = props.retryAttemptTimeout || 1000;\n    return _this;\n  }\n\n  _createClass(OTSubscriber, [{\n    key: 'componentDidMount',\n    value: function componentDidMount() {\n      this.createSubscriber();\n    }\n  }, {\n    key: 'componentDidUpdate',\n    value: function componentDidUpdate(prevProps, prevState) {\n      var _this2 = this;\n\n      var cast = function cast(value, Type, defaultValue) {\n        return value === undefined ? defaultValue : Type(value);\n      };\n\n      var updateSubscriberProperty = function updateSubscriberProperty(key) {\n        var previous = cast(prevProps.properties[key], Boolean, true);\n        var current = cast(_this2.props.properties[key], Boolean, true);\n\n        if (previous !== current) {\n          _this2.state.subscriber[key](current);\n        }\n      };\n\n      updateSubscriberProperty('subscribeToAudio');\n      updateSubscriberProperty('subscribeToVideo');\n\n      if (prevState.session !== this.state.session || prevState.stream !== this.state.stream) {\n        this.destroySubscriber(prevState.session);\n        this.createSubscriber();\n      }\n    }\n  }, {\n    key: 'componentWillUnmount',\n    value: function componentWillUnmount() {\n      this.destroySubscriber();\n    }\n  }, {\n    key: 'getSubscriber',\n    value: function getSubscriber() {\n      return this.state.subscriber;\n    }\n  }, {\n    key: 'createSubscriber',\n    value: function createSubscriber() {\n      var _this3 = this;\n\n      if (!this.state.session || !this.state.stream) {\n        this.setState({\n          subscriber: null\n        });\n        return;\n      }\n\n      var properties = this.props.properties || {};\n      var container = void 0;\n\n      if (properties.insertDefaultUI !== false) {\n        container = document.createElement('div');\n        container.setAttribute('class', 'OTSubscriberContainer');\n        this.node.appendChild(container);\n      }\n\n      this.subscriberId = (0, _uuid2.default)();\n      var subscriberId = this.subscriberId;\n      var subscriber = this.state.session.subscribe(this.state.stream, container, this.props.properties, function (err) {\n        if (subscriberId !== _this3.subscriberId) {\n          // Either this subscriber has been recreated or the\n          // component unmounted so don't invoke any callbacks\n          return;\n        }\n\n        if (err && _this3.props.retry && _this3.state.currentRetryAttempt < _this3.maxRetryAttempts - 1) {\n          // Error during subscribe function\n          _this3.handleRetrySubscriber(); // If there is a retry action, do we want to execute the onError props function?\n          // return;\n\n        }\n\n        if (err && typeof _this3.props.onError === 'function') {\n          _this3.props.onError(err);\n        } else if (!err && typeof _this3.props.onSubscribe === 'function') {\n          _this3.props.onSubscribe();\n        }\n      });\n\n      if (this.props.eventHandlers && _typeof(this.props.eventHandlers) === 'object') {\n        subscriber.on(this.props.eventHandlers);\n      }\n\n      this.setState({\n        subscriber: subscriber\n      });\n    }\n  }, {\n    key: 'handleRetrySubscriber',\n    value: function handleRetrySubscriber() {\n      var _this4 = this;\n\n      setTimeout(function () {\n        _this4.setState(function (state) {\n          return {\n            currentRetryAttempt: state.currentRetryAttempt + 1,\n            subscriber: null\n          };\n        });\n\n        _this4.createSubscriber();\n      }, this.retryAttemptTimeout);\n    }\n  }, {\n    key: 'destroySubscriber',\n    value: function destroySubscriber() {\n      var _this5 = this;\n\n      var session = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : this.props.session;\n      delete this.subscriberId;\n\n      if (this.state.subscriber) {\n        if (this.props.eventHandlers && _typeof(this.props.eventHandlers) === 'object') {\n          this.state.subscriber.once('destroyed', function () {\n            _this5.state.subscriber.off(_this5.props.eventHandlers);\n          });\n        }\n\n        if (session) {\n          session.unsubscribe(this.state.subscriber);\n        }\n      }\n    }\n  }, {\n    key: 'render',\n    value: function render() {\n      var _this6 = this;\n\n      var _props = this.props,\n          className = _props.className,\n          style = _props.style;\n      return _react2.default.createElement('div', {\n        className: className,\n        style: style,\n        ref: function ref(node) {\n          _this6.node = node;\n        }\n      });\n    }\n  }]);\n\n  return OTSubscriber;\n}(_react.Component);\n\nexports.default = OTSubscriber;\nOTSubscriber.propTypes = {\n  stream: _propTypes2.default.shape({\n    streamId: _propTypes2.default.string\n  }),\n  session: _propTypes2.default.shape({\n    subscribe: _propTypes2.default.func,\n    unsubscribe: _propTypes2.default.func\n  }),\n  className: _propTypes2.default.string,\n  style: _propTypes2.default.object,\n  // eslint-disable-line react/forbid-prop-types\n  properties: _propTypes2.default.object,\n  // eslint-disable-line react/forbid-prop-types\n  retry: _propTypes2.default.bool,\n  maxRetryAttempts: _propTypes2.default.number,\n  retryAttemptTimeout: _propTypes2.default.number,\n  eventHandlers: _propTypes2.default.objectOf(_propTypes2.default.func),\n  onSubscribe: _propTypes2.default.func,\n  onError: _propTypes2.default.func\n};\nOTSubscriber.defaultProps = {\n  stream: null,\n  session: null,\n  className: '',\n  style: {},\n  properties: {},\n  retry: false,\n  maxRetryAttempts: 5,\n  retryAttemptTimeout: 1000,\n  eventHandlers: null,\n  onSubscribe: null,\n  onError: null\n};\nOTSubscriber.contextTypes = {\n  stream: _propTypes2.default.shape({\n    streamId: _propTypes2.default.string\n  }),\n  session: _propTypes2.default.shape({\n    subscribe: _propTypes2.default.func,\n    unsubscribe: _propTypes2.default.func\n  })\n};","map":{"version":3,"sources":["/home/developer/Projects/Personal/Doctor-dashboard/Doctor Dash/V11/c2md-web_react/node_modules/opentok-react/dist/OTSubscriber.js"],"names":["Object","defineProperty","exports","value","_typeof","Symbol","iterator","obj","constructor","prototype","_createClass","defineProperties","target","props","i","length","descriptor","enumerable","configurable","writable","key","Constructor","protoProps","staticProps","_react","require","_react2","_interopRequireDefault","_propTypes","_propTypes2","_uuid","_uuid2","__esModule","default","_classCallCheck","instance","TypeError","_possibleConstructorReturn","self","call","ReferenceError","_inherits","subClass","superClass","create","setPrototypeOf","__proto__","OTSubscriber","_Component","context","_this","getPrototypeOf","state","subscriber","stream","session","currentRetryAttempt","maxRetryAttempts","retryAttemptTimeout","componentDidMount","createSubscriber","componentDidUpdate","prevProps","prevState","_this2","cast","Type","defaultValue","undefined","updateSubscriberProperty","previous","properties","Boolean","current","destroySubscriber","componentWillUnmount","getSubscriber","_this3","setState","container","insertDefaultUI","document","createElement","setAttribute","node","appendChild","subscriberId","subscribe","err","retry","handleRetrySubscriber","onError","onSubscribe","eventHandlers","on","_this4","setTimeout","_this5","arguments","once","off","unsubscribe","render","_this6","_props","className","style","ref","Component","propTypes","shape","streamId","string","func","object","bool","number","objectOf","defaultProps","contextTypes"],"mappings":"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","sourcesContent":["'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _react = require('react');\n\nvar _react2 = _interopRequireDefault(_react);\n\nvar _propTypes = require('prop-types');\n\nvar _propTypes2 = _interopRequireDefault(_propTypes);\n\nvar _uuid = require('uuid');\n\nvar _uuid2 = _interopRequireDefault(_uuid);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar OTSubscriber = function (_Component) {\n  _inherits(OTSubscriber, _Component);\n\n  function OTSubscriber(props, context) {\n    _classCallCheck(this, OTSubscriber);\n\n    var _this = _possibleConstructorReturn(this, (OTSubscriber.__proto__ || Object.getPrototypeOf(OTSubscriber)).call(this, props));\n\n    _this.state = {\n      subscriber: null,\n      stream: props.stream || context.stream || null,\n      session: props.session || context.session || null,\n      currentRetryAttempt: 0\n    };\n    _this.maxRetryAttempts = props.maxRetryAttempts || 5;\n    _this.retryAttemptTimeout = props.retryAttemptTimeout || 1000;\n    return _this;\n  }\n\n  _createClass(OTSubscriber, [{\n    key: 'componentDidMount',\n    value: function componentDidMount() {\n      this.createSubscriber();\n    }\n  }, {\n    key: 'componentDidUpdate',\n    value: function componentDidUpdate(prevProps, prevState) {\n      var _this2 = this;\n\n      var cast = function cast(value, Type, defaultValue) {\n        return value === undefined ? defaultValue : Type(value);\n      };\n\n      var updateSubscriberProperty = function updateSubscriberProperty(key) {\n        var previous = cast(prevProps.properties[key], Boolean, true);\n        var current = cast(_this2.props.properties[key], Boolean, true);\n        if (previous !== current) {\n          _this2.state.subscriber[key](current);\n        }\n      };\n\n      updateSubscriberProperty('subscribeToAudio');\n      updateSubscriberProperty('subscribeToVideo');\n\n      if (prevState.session !== this.state.session || prevState.stream !== this.state.stream) {\n        this.destroySubscriber(prevState.session);\n        this.createSubscriber();\n      }\n    }\n  }, {\n    key: 'componentWillUnmount',\n    value: function componentWillUnmount() {\n      this.destroySubscriber();\n    }\n  }, {\n    key: 'getSubscriber',\n    value: function getSubscriber() {\n      return this.state.subscriber;\n    }\n  }, {\n    key: 'createSubscriber',\n    value: function createSubscriber() {\n      var _this3 = this;\n\n      if (!this.state.session || !this.state.stream) {\n        this.setState({ subscriber: null });\n        return;\n      }\n      var properties = this.props.properties || {};\n      var container = void 0;\n      if (properties.insertDefaultUI !== false) {\n        container = document.createElement('div');\n        container.setAttribute('class', 'OTSubscriberContainer');\n        this.node.appendChild(container);\n      }\n\n      this.subscriberId = (0, _uuid2.default)();\n      var subscriberId = this.subscriberId;\n\n\n      var subscriber = this.state.session.subscribe(this.state.stream, container, this.props.properties, function (err) {\n        if (subscriberId !== _this3.subscriberId) {\n          // Either this subscriber has been recreated or the\n          // component unmounted so don't invoke any callbacks\n          return;\n        }\n        if (err && _this3.props.retry && _this3.state.currentRetryAttempt < _this3.maxRetryAttempts - 1) {\n          // Error during subscribe function\n          _this3.handleRetrySubscriber();\n          // If there is a retry action, do we want to execute the onError props function?\n          // return;\n        }\n        if (err && typeof _this3.props.onError === 'function') {\n          _this3.props.onError(err);\n        } else if (!err && typeof _this3.props.onSubscribe === 'function') {\n          _this3.props.onSubscribe();\n        }\n      });\n\n      if (this.props.eventHandlers && _typeof(this.props.eventHandlers) === 'object') {\n        subscriber.on(this.props.eventHandlers);\n      }\n\n      this.setState({ subscriber: subscriber });\n    }\n  }, {\n    key: 'handleRetrySubscriber',\n    value: function handleRetrySubscriber() {\n      var _this4 = this;\n\n      setTimeout(function () {\n        _this4.setState(function (state) {\n          return {\n            currentRetryAttempt: state.currentRetryAttempt + 1,\n            subscriber: null\n          };\n        });\n        _this4.createSubscriber();\n      }, this.retryAttemptTimeout);\n    }\n  }, {\n    key: 'destroySubscriber',\n    value: function destroySubscriber() {\n      var _this5 = this;\n\n      var session = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : this.props.session;\n\n      delete this.subscriberId;\n\n      if (this.state.subscriber) {\n        if (this.props.eventHandlers && _typeof(this.props.eventHandlers) === 'object') {\n          this.state.subscriber.once('destroyed', function () {\n            _this5.state.subscriber.off(_this5.props.eventHandlers);\n          });\n        }\n\n        if (session) {\n          session.unsubscribe(this.state.subscriber);\n        }\n      }\n    }\n  }, {\n    key: 'render',\n    value: function render() {\n      var _this6 = this;\n\n      var _props = this.props,\n          className = _props.className,\n          style = _props.style;\n\n      return _react2.default.createElement('div', { className: className, style: style, ref: function ref(node) {\n          _this6.node = node;\n        } });\n    }\n  }]);\n\n  return OTSubscriber;\n}(_react.Component);\n\nexports.default = OTSubscriber;\n\n\nOTSubscriber.propTypes = {\n  stream: _propTypes2.default.shape({\n    streamId: _propTypes2.default.string\n  }),\n  session: _propTypes2.default.shape({\n    subscribe: _propTypes2.default.func,\n    unsubscribe: _propTypes2.default.func\n  }),\n  className: _propTypes2.default.string,\n  style: _propTypes2.default.object, // eslint-disable-line react/forbid-prop-types\n  properties: _propTypes2.default.object, // eslint-disable-line react/forbid-prop-types\n  retry: _propTypes2.default.bool,\n  maxRetryAttempts: _propTypes2.default.number,\n  retryAttemptTimeout: _propTypes2.default.number,\n  eventHandlers: _propTypes2.default.objectOf(_propTypes2.default.func),\n  onSubscribe: _propTypes2.default.func,\n  onError: _propTypes2.default.func\n};\n\nOTSubscriber.defaultProps = {\n  stream: null,\n  session: null,\n  className: '',\n  style: {},\n  properties: {},\n  retry: false,\n  maxRetryAttempts: 5,\n  retryAttemptTimeout: 1000,\n  eventHandlers: null,\n  onSubscribe: null,\n  onError: null\n};\n\nOTSubscriber.contextTypes = {\n  stream: _propTypes2.default.shape({\n    streamId: _propTypes2.default.string\n  }),\n  session: _propTypes2.default.shape({\n    subscribe: _propTypes2.default.func,\n    unsubscribe: _propTypes2.default.func\n  })\n};"]},"metadata":{},"sourceType":"script"}