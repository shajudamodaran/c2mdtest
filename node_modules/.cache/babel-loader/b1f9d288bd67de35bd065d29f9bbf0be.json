{"ast":null,"code":"var _jsxFileName = \"/home/veena/Downloads/connect2mydoctor-phase1/connect2mydoctor-phase1/src/components/UploadReports/index.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useEffect, useRef } from \"react\";\nimport Style from \"./UploadReports.module.scss\";\nimport YesNoButton from \"../YesNoButton\";\nimport Assets from \"../Layout/Assets\";\nimport { Accordion, Button } from \"react-bootstrap\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport moment from \"moment\";\nimport axios from \"axios\";\nimport { FileDrop } from \"react-file-drop\";\nimport { fetch_Uploaded_files } from \"../../actions/FamilyMembersAction\";\nimport { toast } from \"react-toastify\";\nimport ConfirmModal from \"./ConfirmModal\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\n\nfunction UploadReports({\n  progressIncrementer,\n  appoinment_form,\n  Store_formData\n}) {\n  _s();\n\n  var _appoinment_form$repo;\n\n  const fileInputRef = useRef(null);\n  const [error, setError] = useState(false);\n  const [deleteItems, setDeleteItem] = useState(\"\");\n  const [errorLimit, setErrorLimit] = useState(false);\n  const userData = useSelector(state => state.login);\n  const [toastOpen, setToastOpen] = useState(false);\n  const uploadedData = useSelector(state => {\n    var _state$bookAppoinment;\n\n    return (_state$bookAppoinment = state.bookAppoinment.uploadedData) === null || _state$bookAppoinment === void 0 ? void 0 : _state$bookAppoinment.reportList;\n  });\n  const [showModal, setShowModal] = useState(false);\n  const [fileItem, setFileName] = useState([]);\n  const [uploads, setUploads] = useState(appoinment_form === null || appoinment_form === void 0 ? void 0 : appoinment_form.reportsArray);\n  const [selectedFiles, setSelectedFiles] = useState(appoinment_form.selectedFiles ? appoinment_form.selectedFiles : []); // console.log(selectedFiles,\"this is aupted\")\n\n  useEffect(() => {\n    var _userData$user;\n\n    dispatch(fetch_Uploaded_files({\n      userId: userData === null || userData === void 0 ? void 0 : (_userData$user = userData.user) === null || _userData$user === void 0 ? void 0 : _userData$user.userId\n    }));\n    document.querySelector(\"body\").scrollTo(0, 0);\n  }, []);\n  const dispatch = useDispatch();\n  const [reports, setReports] = useState({\n    flag: (appoinment_form === null || appoinment_form === void 0 ? void 0 : (_appoinment_form$repo = appoinment_form.reportsArray) === null || _appoinment_form$repo === void 0 ? void 0 : _appoinment_form$repo.length) > 0 ? \"Yes\" : \"\",\n    url: \"\"\n  });\n  const [showError, setShowError] = useState(false);\n\n  const onTargetClick = () => {\n    fileInputRef.current.click();\n  };\n\n  const yes_btn_Change = () => {\n    setReports({ ...reports,\n      flag: \"Yes\"\n    });\n  };\n\n  const No_btn_Change = () => {\n    setReports({ ...reports,\n      flag: \"No\"\n    });\n    progressIncrementer();\n  };\n\n  const Continue = () => {\n    let NewArry = fileItem.push(appoinment_form.reports);\n\n    if ((uploads === null || uploads === void 0 ? void 0 : uploads.length) >= 1 || selectFiles.length >= 1) {\n      setShowError(false);\n      dispatch(Store_formData({ ...appoinment_form,\n        reports: fileItem === null || fileItem === void 0 ? void 0 : fileItem.toString(),\n        reportsArray: uploads,\n        selectedFiles: selectedFiles\n      }));\n      progressIncrementer();\n    } else {\n      setShowError(true);\n    }\n  };\n\n  const onFileChange = file => {\n    // const file = e.target.files[0];\n    let imgSize = parseFloat((file === null || file === void 0 ? void 0 : file.size) / (1024 * 1024)).toFixed(2);\n\n    if (uploads.length <= 4) {\n      if (imgSize < 5) {\n        setError(false);\n        const formData = new FormData();\n        formData.append(\"name\", file.name);\n        formData.append(\"file\", file);\n        axios.post(\"https://uat.c2mdr.com/c2mydrrestdemo/v1/c2mdapi/reportsuploads\", formData, {}).then(res => {\n          var _res$data$data$fileNa;\n\n          let imgname = (_res$data$data$fileNa = res.data.data.fileName) === null || _res$data$data$fileNa === void 0 ? void 0 : _res$data$data$fileNa.split(\"!\");\n          setFileName([...fileItem, res.data && res.data.data.fileName]);\n          setShowError(false);\n          setUploads([...uploads, {\n            title: imgname[0],\n            uploaded: moment().format(\"DD-MM-YYYY\"),\n            status: true,\n            resName: res.data.data.fileName\n          }]);\n        }).catch(error => {});\n      } else {\n        setError(true);\n      }\n    } else {\n      if (!toastOpen) {\n        toast.error(\"Only 5 files are allowed to upload\", {\n          position: toast.POSITION.TOP_CENTER,\n          hideProgressBar: true,\n          onOpen: props => setToastOpen(true),\n          onClose: props => setToastOpen(false)\n        });\n      }\n    }\n  };\n\n  const fileUpload = event => {\n    let files = [...event.dataTransfer.files];\n  };\n\n  const deleteUploads = item => {\n    setShowModal(true);\n    setDeleteItem(item);\n  };\n\n  const onCancel = item => {\n    axios.post(\"https://uat.c2mdr.com/c2mydrrestdemo/v1/c2mdapi/removereports\", {\n      requestType: 596,\n      token: \"C2MDVerificationToken\",\n      data: {\n        filename: item === null || item === void 0 ? void 0 : item.title\n      }\n    }).then(res => {\n      // if (res.data.info === \"Success\") {\n      let filter1 = uploads.filter(obj => {\n        return obj.title != item.title;\n      });\n      let filter2 = fileItem.filter(value => {\n        return value != item.resName;\n      });\n      setUploads(filter1);\n      setFileName(filter2);\n      dispatch(Store_formData({ ...appoinment_form,\n        reports: filter2 === null || filter2 === void 0 ? void 0 : filter2.toString(),\n        reportsArray: filter1\n      }));\n      setShowModal(false); // } else {\n      // }\n    }).catch(error => {});\n  };\n\n  const selectFiles = (file, index) => {\n    if (selectedFiles.includes(file)) {\n      let x = [...selectedFiles];\n      x = x.filter(function (el) {\n        return el.filename != file.filename;\n      });\n      let y = [...fileItem];\n      y = y.filter(function (el) {\n        return el.filename != file.filename;\n      });\n      setSelectedFiles(x);\n      setFileName(y);\n    } else {\n      setSelectedFiles([...selectedFiles, file]);\n      setFileName([...fileItem, file.filename]);\n    }\n  };\n\n  const isSelected = file => {\n    // console.log(selectedFiles,file)\n    // selectedFiles.filter(function(el) { return el.filename == file.filename })\n    if (selectedFiles.some(item => item.filename === file.filename && item.uploadRefId == file.uploadRefId)) {\n      return true;\n    }\n\n    return false;\n  };\n\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n      className: Style.upload_reports_main_heading,\n      children: \"Do you have any reports to upload?\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 193,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(YesNoButton, {\n      yes_btn_Change: yes_btn_Change,\n      No_btn_Change: No_btn_Change,\n      flag: reports.flag\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 196,\n      columnNumber: 7\n    }, this), reports.flag === \"Yes\" && /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: [/*#__PURE__*/_jsxDEV(Accordion, {\n        defaultActiveKey: \"1\",\n        className: `${Style.upload_reports_accordion_align}`,\n        children: [/*#__PURE__*/_jsxDEV(Accordion.Item, {\n          eventKey: \"0\",\n          className: `${uploads.length == 0 && Style.noFiles}`,\n          children: [/*#__PURE__*/_jsxDEV(Accordion.Header, {\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              className: Style.upload_button,\n              children: [/*#__PURE__*/_jsxDEV(\"input\", {\n                type: \"file\",\n                id: \"upload\",\n                accept: \".png, .jpg, .pdf\",\n                ref: fileInputRef,\n                onChange: e => {\n                  onFileChange(e.target.files[0]);\n                }\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 210,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(FileDrop, {\n                onFrameDragEnter: event => console.log(\"onFrameDragEnter\", event),\n                onFrameDragLeave: event => console.log(\"onFrameDragLeave\", event),\n                onFrameDrop: event => console.log(\"onFrameDrop\", event),\n                onDragOver: event => console.log(\"onDragOver\", event),\n                onDragLeave: event => console.log(\"onDragLeave\", event),\n                onDrop: (files, event) => {\n                  onFileChange(files[0]);\n                },\n                children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                  for: \"upload\",\n                  children: [/*#__PURE__*/_jsxDEV(\"img\", {\n                    src: Assets.file_icon\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 234,\n                    columnNumber: 23\n                  }, this), \"Open Files\", \" \"]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 233,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: Style.imageFormat,\n                  children: \"(Supported formats - PDF, PNG, JPEG, JPG, DOC, DOCX, DCM, ZIP. File limits - 5 files of 5MB per file)\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 236,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 219,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 209,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 208,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(Accordion.Body, {\n            children: uploads && uploads.map((item, index) => {\n              return /*#__PURE__*/_jsxDEV(\"div\", {\n                className: Style.upload_reports_location_content_selected,\n                children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                  className: Style.upload_reports_count,\n                  children: index + 1\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 261,\n                  columnNumber: 25\n                }, this), /*#__PURE__*/_jsxDEV(\"img\", {\n                  src: Assets.pdf_icon,\n                  className: Style.upload_reports_pdf_icon\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 264,\n                  columnNumber: 25\n                }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: Style.upload_reports_dropdown_content,\n                  children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                    children: item.name\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 269,\n                    columnNumber: 27\n                  }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                    className: Style.upload_reports_description,\n                    children: [item.title, \" - \", item.uploaded]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 270,\n                    columnNumber: 27\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 268,\n                  columnNumber: 25\n                }, this), /*#__PURE__*/_jsxDEV(\"figure\", {\n                  children: /*#__PURE__*/_jsxDEV(\"img\", {\n                    src: Assets.tick_icon,\n                    className: Style.upload_reports_tick_icon\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 275,\n                    columnNumber: 27\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 274,\n                  columnNumber: 25\n                }, this), /*#__PURE__*/_jsxDEV(\"figure\", {\n                  children: /*#__PURE__*/_jsxDEV(\"img\", {\n                    src: Assets.deleteIcon,\n                    className: Style.upload_reports_Delete_icon,\n                    onClick: () => deleteUploads(item)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 281,\n                    columnNumber: 27\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 280,\n                  columnNumber: 25\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 256,\n                columnNumber: 23\n              }, this);\n            })\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 252,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 207,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(Accordion.Item, {\n          eventKey: \"2\",\n          className: `${uploadedData.length == 0 && Style.noFiles}`,\n          children: [/*#__PURE__*/_jsxDEV(Accordion.Header, {\n            children: /*#__PURE__*/_jsxDEV(\"span\", {\n              className: Style.upload_reports_location_heading,\n              children: [/*#__PURE__*/_jsxDEV(\"img\", {\n                src: Assets.upload_icon,\n                className: Style.upload_reports_upload_icon\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 295,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                className: Style.upload_reports_dropdown_heading,\n                children: [\"From My Uploads (\", uploadedData === null || uploadedData === void 0 ? void 0 : uploadedData.length, /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: Style.reportsText,\n                  children: \"reports\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 301,\n                  columnNumber: 21\n                }, this), \")\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 299,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 294,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 293,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(Accordion.Body, {\n            children: uploadedData && uploadedData.map((item, index) => {\n              if (item.filename && item.filename != ',') {\n                return /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: `${Style.upload_reports_location_content_selected} ${isSelected(item) && Style.active}`,\n                  onClick: () => {\n                    selectFiles(item, index);\n                  },\n                  children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                    className: Style.upload_reports_count,\n                    children: index + 1\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 315,\n                    columnNumber: 27\n                  }, this), /*#__PURE__*/_jsxDEV(\"img\", {\n                    src: Assets.pdf_icon,\n                    className: Style.upload_reports_pdf_icon\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 318,\n                    columnNumber: 27\n                  }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                    className: Style.upload_reports_dropdown_content,\n                    children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                      children: item.filename\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 323,\n                      columnNumber: 29\n                    }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                      className: Style.upload_reports_description,\n                      children: item.dateOfReport\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 324,\n                      columnNumber: 29\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 322,\n                    columnNumber: 27\n                  }, this), isSelected(item) && /*#__PURE__*/_jsxDEV(\"figure\", {\n                    children: /*#__PURE__*/_jsxDEV(\"img\", {\n                      src: Assets.tick_icon,\n                      className: Style.upload_reports_tick_icon\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 329,\n                      columnNumber: 29\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 328,\n                    columnNumber: 46\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 311,\n                  columnNumber: 25\n                }, this);\n              }\n            })\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 305,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 292,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 203,\n        columnNumber: 11\n      }, this), error && /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [\" \", /*#__PURE__*/_jsxDEV(\"p\", {\n          className: Style.ShowErrormsg,\n          children: \"Please select image size less than 5 MB\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 380,\n          columnNumber: 15\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 378,\n        columnNumber: 13\n      }, this), showError && /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [\" \", /*#__PURE__*/_jsxDEV(\"p\", {\n          className: Style.ShowErrormsg,\n          children: \"Please upload report\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 389,\n          columnNumber: 15\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 387,\n        columnNumber: 13\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: `${Style.btn_floating} btn_floating`,\n        children: /*#__PURE__*/_jsxDEV(Button, {\n          className: Style.upload_reports_continue_button,\n          onClick: progressIncrementer,\n          onClick: Continue,\n          children: \"Continue\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 393,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 392,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true), /*#__PURE__*/_jsxDEV(ConfirmModal, {\n      showModal: showModal,\n      setShowModal: setShowModal,\n      onCancel: onCancel,\n      deleteItems: deleteItems\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 403,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true);\n}\n\n_s(UploadReports, \"p9t1yKL3mgf/98et9k81unVRooY=\", false, function () {\n  return [useSelector, useSelector, useDispatch];\n});\n\n_c = UploadReports;\nexport default UploadReports;\n\nvar _c;\n\n$RefreshReg$(_c, \"UploadReports\");","map":{"version":3,"sources":["/home/veena/Downloads/connect2mydoctor-phase1/connect2mydoctor-phase1/src/components/UploadReports/index.js"],"names":["React","useState","useEffect","useRef","Style","YesNoButton","Assets","Accordion","Button","useDispatch","useSelector","moment","axios","FileDrop","fetch_Uploaded_files","toast","ConfirmModal","UploadReports","progressIncrementer","appoinment_form","Store_formData","fileInputRef","error","setError","deleteItems","setDeleteItem","errorLimit","setErrorLimit","userData","state","login","toastOpen","setToastOpen","uploadedData","bookAppoinment","reportList","showModal","setShowModal","fileItem","setFileName","uploads","setUploads","reportsArray","selectedFiles","setSelectedFiles","dispatch","userId","user","document","querySelector","scrollTo","reports","setReports","flag","length","url","showError","setShowError","onTargetClick","current","click","yes_btn_Change","No_btn_Change","Continue","NewArry","push","selectFiles","toString","onFileChange","file","imgSize","parseFloat","size","toFixed","formData","FormData","append","name","post","then","res","imgname","data","fileName","split","title","uploaded","format","status","resName","catch","position","POSITION","TOP_CENTER","hideProgressBar","onOpen","props","onClose","fileUpload","event","files","dataTransfer","deleteUploads","item","onCancel","requestType","token","filename","filter1","filter","obj","filter2","value","index","includes","x","el","y","isSelected","some","uploadRefId","upload_reports_main_heading","upload_reports_accordion_align","noFiles","upload_button","e","target","console","log","file_icon","imageFormat","map","upload_reports_location_content_selected","upload_reports_count","pdf_icon","upload_reports_pdf_icon","upload_reports_dropdown_content","upload_reports_description","tick_icon","upload_reports_tick_icon","deleteIcon","upload_reports_Delete_icon","upload_reports_location_heading","upload_icon","upload_reports_upload_icon","upload_reports_dropdown_heading","reportsText","active","dateOfReport","ShowErrormsg","btn_floating","upload_reports_continue_button"],"mappings":"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","sourcesContent":["import React, { useState, useEffect, useRef } from \"react\";\nimport Style from \"./UploadReports.module.scss\";\nimport YesNoButton from \"../YesNoButton\";\nimport Assets from \"../Layout/Assets\";\nimport { Accordion, Button } from \"react-bootstrap\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport moment from \"moment\";\nimport axios from \"axios\";\nimport { FileDrop } from \"react-file-drop\";\nimport { fetch_Uploaded_files } from \"../../actions/FamilyMembersAction\";\nimport { toast } from \"react-toastify\";\nimport ConfirmModal from \"./ConfirmModal\";\nfunction UploadReports({\n  progressIncrementer,\n  appoinment_form,\n  Store_formData,\n}) {\n  const fileInputRef = useRef(null);\n  const [error, setError] = useState(false);\n  const [deleteItems, setDeleteItem] = useState(\"\");\n  const [errorLimit, setErrorLimit] = useState(false);\n  const userData = useSelector((state) => state.login);\n  const [toastOpen, setToastOpen] = useState(false);\n  const uploadedData = useSelector(\n    (state) => state.bookAppoinment.uploadedData?.reportList\n  );\n  const [showModal, setShowModal] = useState(false);\n\n  const [fileItem, setFileName] = useState([]);\n  const [uploads, setUploads] = useState(appoinment_form?.reportsArray);\n  const [selectedFiles,setSelectedFiles] = useState(appoinment_form.selectedFiles?appoinment_form.selectedFiles:[]);\n// console.log(selectedFiles,\"this is aupted\")\n  useEffect(() => {\n    dispatch(fetch_Uploaded_files({ userId: userData?.user?.userId }));\n    document.querySelector(\"body\").scrollTo(0, 0);\n  }, []);\n  const dispatch = useDispatch();\n  const [reports, setReports] = useState({\n    flag: appoinment_form?.reportsArray?.length > 0 ? \"Yes\" : \"\",\n    url: \"\",\n  });\n\n  const [showError, setShowError] = useState(false);\n  const onTargetClick = () => {\n    fileInputRef.current.click();\n  };\n\n  const yes_btn_Change = () => {\n    setReports({ ...reports, flag: \"Yes\" });\n  };\n  const No_btn_Change = () => {\n    setReports({ ...reports, flag: \"No\" });\n    progressIncrementer();\n  };\n\n  const Continue = () => {\n    let NewArry = fileItem.push(appoinment_form.reports);\n\n    if (uploads?.length >= 1||selectFiles.length>=1) {\n      setShowError(false);\n      dispatch(\n        Store_formData({\n          ...appoinment_form,\n          reports: fileItem?.toString(),\n          reportsArray: uploads,\n          selectedFiles:selectedFiles\n        })\n      );\n      progressIncrementer();\n    } else {\n      setShowError(true);\n    }\n  };\n\n  const onFileChange = (file) => {\n    // const file = e.target.files[0];\n\n    let imgSize = parseFloat(file?.size / (1024 * 1024)).toFixed(2);\n\n    if (uploads.length <= 4) {\n      if (imgSize < 5) {\n        setError(false);\n        const formData = new FormData();\n        formData.append(\"name\", file.name);\n        formData.append(\"file\", file);\n\n        axios\n          .post(\n            \"https://uat.c2mdr.com/c2mydrrestdemo/v1/c2mdapi/reportsuploads\",\n            formData,\n            {}\n          )\n          .then((res) => {\n            let imgname = res.data.data.fileName?.split(\"!\");\n\n            setFileName([...fileItem, res.data && res.data.data.fileName]);\n            setShowError(false);\n            setUploads([\n              ...uploads,\n              {\n                title: imgname[0],\n                uploaded: moment().format(\"DD-MM-YYYY\"),\n                status: true,\n                resName: res.data.data.fileName,\n              },\n            ]);\n          })\n          .catch((error) => {});\n      } else {\n        setError(true);\n      }\n    } else {\n      if (!toastOpen) {\n        toast.error(\"Only 5 files are allowed to upload\", {\n          position: toast.POSITION.TOP_CENTER,\n          hideProgressBar:true,\n          onOpen: (props) => setToastOpen(true),\n          onClose: (props) => setToastOpen(false),\n        });\n      }\n    }\n  };\n\n  const fileUpload = (event) => {\n    let files = [...event.dataTransfer.files];\n  };\n  const deleteUploads = (item) => {\n    setShowModal(true);\n    setDeleteItem(item);\n  };\n  const onCancel = (item) => {\n    axios\n      .post(\n        \"https://uat.c2mdr.com/c2mydrrestdemo/v1/c2mdapi/removereports\",\n\n        {\n          requestType: 596,\n          token: \"C2MDVerificationToken\",\n          data: { filename: item?.title },\n        }\n      )\n      .then((res) => {\n        // if (res.data.info === \"Success\") {\n\n        let filter1 = uploads.filter((obj) => {\n          return obj.title != item.title;\n        });\n        let filter2 = fileItem.filter((value) => {\n          return value != item.resName;\n        });\n        setUploads(filter1);\n        setFileName(filter2);\n        dispatch(\n          Store_formData({\n            ...appoinment_form,\n            reports: filter2?.toString(),\n            reportsArray: filter1,\n          })\n        );\n        setShowModal(false);\n        // } else {\n        // }\n      })\n      .catch((error) => {});\n  };\n\n  const selectFiles = (file,index) => {\n    if(selectedFiles.includes(file)){\n      let x = [...selectedFiles]\n      x = x.filter(function(el) { return el.filename != file.filename })\n      let y = [...fileItem]\n      y = y.filter(function(el) { return el.filename != file.filename })\n      setSelectedFiles(x)\n      setFileName(y)\n\n    }else{\n      setSelectedFiles([...selectedFiles,file])\n      setFileName([...fileItem, file.filename]);\n    }\n  }\n\n  const isSelected = (file) =>{\n    // console.log(selectedFiles,file)\n    // selectedFiles.filter(function(el) { return el.filename == file.filename })\n    if(selectedFiles.some(item => item.filename === file.filename&&item.uploadRefId==file.uploadRefId)){\n      return true;\n    }\n    return false;\n  }\n\n  return (\n    <>\n      <h3 className={Style.upload_reports_main_heading}>\n        Do you have any reports to upload?\n      </h3>\n      <YesNoButton\n        yes_btn_Change={yes_btn_Change}\n        No_btn_Change={No_btn_Change}\n        flag={reports.flag}\n      />\n      {reports.flag === \"Yes\" && (\n        <>\n          <Accordion\n            defaultActiveKey=\"1\"\n            className={`${Style.upload_reports_accordion_align}`}\n          >\n            <Accordion.Item eventKey=\"0\" className={`${uploads.length==0&&Style.noFiles}`}>\n              <Accordion.Header>\n                <div className={Style.upload_button}>\n                  <input\n                    type=\"file\"\n                    id=\"upload\"\n                    accept=\".png, .jpg, .pdf\"\n                    ref={fileInputRef}\n                    onChange={(e) => {\n                      onFileChange(e.target.files[0]);\n                    }}\n                  />\n                  <FileDrop\n                    onFrameDragEnter={(event) =>\n                      console.log(\"onFrameDragEnter\", event)\n                    }\n                    onFrameDragLeave={(event) =>\n                      console.log(\"onFrameDragLeave\", event)\n                    }\n                    onFrameDrop={(event) => console.log(\"onFrameDrop\", event)}\n                    onDragOver={(event) => console.log(\"onDragOver\", event)}\n                    onDragLeave={(event) => console.log(\"onDragLeave\", event)}\n                    onDrop={(files, event) => {\n                      onFileChange(files[0]);\n                    }}\n                  >\n                    <label for=\"upload\">\n                      <img src={Assets.file_icon}></img>Open Files{\" \"}\n                    </label>\n                    <span className={Style.imageFormat}>\n                      (Supported formats - PDF, PNG, JPEG, JPG, DOC, DOCX, DCM,\n                      ZIP. File limits - 5 files of 5MB per file)\n                    </span>\n                  </FileDrop>\n                </div>\n                {/* <span className={Style.upload_reports_location_heading} onClick={fileUpload}>\n                  <img\n                    src={Assets.upload_icon}\n                    className={Style.upload_reports_upload_icon}\n                  ></img>\n                  <span className={Style.upload_reports_dropdown_heading}>\n                    Upload your reports here ({uploads.length} reports)\n                  </span>\n                </span> */}\n              </Accordion.Header>\n              <Accordion.Body>\n                {uploads &&\n                  uploads.map((item, index) => {\n                    return (\n                      <div\n                        className={\n                          Style.upload_reports_location_content_selected\n                        }\n                      >\n                        <span className={Style.upload_reports_count}>\n                          {index + 1}\n                        </span>\n                        <img\n                          src={Assets.pdf_icon}\n                          className={Style.upload_reports_pdf_icon}\n                        ></img>\n                        <span className={Style.upload_reports_dropdown_content}>\n                          <span>{item.name}</span>\n                          <span className={Style.upload_reports_description}>\n                            {item.title} - {item.uploaded}\n                          </span>\n                        </span>\n                        <figure>\n                          <img\n                            src={Assets.tick_icon}\n                            className={Style.upload_reports_tick_icon}\n                          ></img>\n                        </figure>\n                        <figure>\n                          <img\n                            src={Assets.deleteIcon}\n                            className={Style.upload_reports_Delete_icon}\n                            onClick={() => deleteUploads(item)}\n                          />\n                        </figure>\n                      </div>\n                    );\n                  })}\n              </Accordion.Body>\n            </Accordion.Item>\n            <Accordion.Item eventKey=\"2\" className={`${uploadedData.length==0&&Style.noFiles}`}>\n              <Accordion.Header>\n                <span className={Style.upload_reports_location_heading}>\n                  <img\n                    src={Assets.upload_icon}\n                    className={Style.upload_reports_upload_icon}\n                  ></img>\n                  <span className={Style.upload_reports_dropdown_heading}>\n                    From My Uploads ({uploadedData?.length}\n                    <span className={Style.reportsText}>reports</span>)\n                  </span>\n                </span>\n              </Accordion.Header>\n              <Accordion.Body>\n                {uploadedData &&\n                  uploadedData.map((item, index) => {\n                    if(item.filename&&item.filename!=',')\n                    {\n                      return (\n                        <div\n                          className={`${Style.upload_reports_location_content_selected} ${isSelected(item)&&Style.active}`}\n                          onClick={()=>{selectFiles(item,index)}}\n                        >\n                          <span className={Style.upload_reports_count}>\n                            {index + 1}\n                          </span>\n                          <img\n                            src={Assets.pdf_icon}\n                            className={Style.upload_reports_pdf_icon}\n                          ></img>\n                          <span className={Style.upload_reports_dropdown_content}>\n                            <span>{item.filename}</span>\n                            <span className={Style.upload_reports_description}>\n                               {item.dateOfReport}\n                            </span>\n                          </span>\n                          {isSelected(item)&&<figure>\n                            <img\n                              src={Assets.tick_icon}\n                              className={Style.upload_reports_tick_icon}\n                            ></img>\n                          </figure>}\n                        </div>\n                      );\n                    }\n                    \n                  })}\n\n                {/* <div\n                  className={Style.upload_reports_location_content_unselected}\n                >\n                  <span className={Style.upload_reports_count}>2</span>\n                  <img\n                    src={Assets.pdf_icon}\n                    className={Style.upload_reports_pdf_icon}\n                  ></img>\n                  <span className={Style.upload_reports_dropdown_content}>\n                    <span>Medical report</span>\n                    <span className={Style.upload_reports_description}>\n                      Uploaded - 18-8-2021\n                    </span>\n                  </span>\n                </div> */}\n              </Accordion.Body>\n            </Accordion.Item>\n          </Accordion>\n          {/* <Button className={Style.upload_reports_open_files}>\n                    <img src={Assets.file_icon}></img>\n                    Open Files\n            </Button> */}\n          {/* <div className={Style.upload_button}>\n            <input type=\"file\" id=\"upload\" ref={fileInputRef} onChange={(e)=>{onFileChange(e.target.files[0])}} />\n            <FileDrop\n          onFrameDragEnter={(event) => console.log('onFrameDragEnter', event)}\n          onFrameDragLeave={(event) => console.log('onFrameDragLeave', event)}\n          onFrameDrop={(event) => console.log('onFrameDrop', event)}\n          onDragOver={(event) => console.log('onDragOver', event)}\n          onDragLeave={(event) => console.log('onDragLeave', event)}\n          onDrop={(files, event) => {console.log('onDrop!', files, event); onFileChange(files[0])}}\n        >\n            <label for=\"upload\">\n              <img src={Assets.file_icon}></img>Open Files\n            </label>\n            </FileDrop>\n          </div> */}\n          {error && (\n            <div>\n              {\" \"}\n              <p className={Style.ShowErrormsg}>\n                Please select image size less than 5 MB\n              </p>\n            </div>\n          )}\n\n          {showError && (\n            <div>\n              {\" \"}\n              <p className={Style.ShowErrormsg}>Please upload report</p>\n            </div>\n          )}\n          <div className={`${Style.btn_floating} btn_floating`}>\n            <Button\n              className={Style.upload_reports_continue_button}\n              onClick={progressIncrementer}\n              onClick={Continue}\n            >\n              Continue\n            </Button>\n          </div>\n        </>\n      )}\n      <ConfirmModal\n        showModal={showModal}\n        setShowModal={setShowModal}\n        onCancel={onCancel}\n        deleteItems={deleteItems}\n      />\n    </>\n  );\n}\n\nexport default UploadReports;\n"]},"metadata":{},"sourceType":"module"}